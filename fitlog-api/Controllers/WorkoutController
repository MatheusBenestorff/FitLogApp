namespace FitLogApp.api.Controllers;

[ApiController]
[Route("api/[controller]")]
[Authorize]
public class WorkoutController : ControllerBase
{
    private readonly AppDbContext _appDbContext;
    private readonly ITokenService _tokenService;

    [HttpGet]
    public async Task<ActionResult<IEnumerable<Workout>>> GetAllWorkoutsByUser()
    {
        var userIdString = User.FindFirstValue(ClaimTypes.NameIdentifier);

        if (string.IsNullOrEmpty(userIdString))
        {
            return Unauthorized();
        }

        var userId = int.Parse(userIdString);

        var workouts = await _appDbContext.Workouts
            .Where(w => w.UserId == userId)
            .ToListAsync();

        return Ok(workouts);
    }


}
